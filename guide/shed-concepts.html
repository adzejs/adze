<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Shed Concepts | Adze JS</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script async="true" defer="true" data-domain="adzejs.com" src="https://plausible.io/js/plausible.js"></script>
    <script async="true" src="https://cdn.jsdelivr.net/npm/adze@0.5.5/dist/adze.min.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Share&amp;display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" sizes="64x64" href="/favicon.png">
    <meta name="description" content="A library for shaping your logs.">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.678a9b04.css" as="style"><link rel="preload" href="/assets/js/app.57169c33.js" as="script"><link rel="preload" href="/assets/js/2.1b8b686a.js" as="script"><link rel="preload" href="/assets/js/18.99843d9e.js" as="script"><link rel="prefetch" href="/assets/js/10.262e27dc.js"><link rel="prefetch" href="/assets/js/11.4072efe5.js"><link rel="prefetch" href="/assets/js/12.c9344996.js"><link rel="prefetch" href="/assets/js/13.dca1a1fe.js"><link rel="prefetch" href="/assets/js/14.e17ee109.js"><link rel="prefetch" href="/assets/js/15.2033fa84.js"><link rel="prefetch" href="/assets/js/16.7816276f.js"><link rel="prefetch" href="/assets/js/17.2e344aba.js"><link rel="prefetch" href="/assets/js/19.c3ad06b3.js"><link rel="prefetch" href="/assets/js/20.96916feb.js"><link rel="prefetch" href="/assets/js/21.0c0ecb83.js"><link rel="prefetch" href="/assets/js/22.eb54e891.js"><link rel="prefetch" href="/assets/js/23.505cdf61.js"><link rel="prefetch" href="/assets/js/24.6ba282ad.js"><link rel="prefetch" href="/assets/js/3.c53ffbf5.js"><link rel="prefetch" href="/assets/js/4.06f3f2b8.js"><link rel="prefetch" href="/assets/js/5.541f9492.js"><link rel="prefetch" href="/assets/js/6.70c39a4f.js"><link rel="prefetch" href="/assets/js/7.29a1e264.js"><link rel="prefetch" href="/assets/js/8.a62fa423.js"><link rel="prefetch" href="/assets/js/9.b1b67508.js">
    <link rel="stylesheet" href="/assets/css/0.styles.678a9b04.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/icon.svg" alt="Adze JS" class="logo"> <span class="site-name can-hide">Adze JS</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/config/" class="nav-link">
  Config
</a></div> <a href="https://github.com/AJStacy/Adze" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/config/" class="nav-link">
  Config
</a></div> <a href="https://github.com/AJStacy/Adze" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/guide/installation.html" class="sidebar-link">Installing Adze</a></li><li><a href="/guide/adze-concepts.html" class="sidebar-link">Adze Concepts</a></li><li><a href="/guide/factories.html" class="sidebar-link">Factories</a></li><li><a href="/guide/modifiers.html" class="sidebar-link">Modifiers</a></li><li><a href="/guide/default-terminators.html" class="sidebar-link">Default Terminators</a></li><li><a href="/guide/other-terminators.html" class="sidebar-link">Other Terminators</a></li><li><a href="/guide/filtering-and-utility-functions.html" class="sidebar-link">Filtering &amp; Utility Functions</a></li><li><a href="/guide/getters-and-setters.html" class="sidebar-link">Getters and Setters</a></li><li><a href="/guide/data.html" class="sidebar-link">Data</a></li><li><a href="/guide/shed-concepts.html" aria-current="page" class="active sidebar-link">Shed Concepts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/shed-concepts.html#what-is-a-shed" class="sidebar-link">What is a Shed?</a></li><li class="sidebar-sub-header"><a href="/guide/shed-concepts.html#how-does-it-work" class="sidebar-link">How does it work?</a></li><li class="sidebar-sub-header"><a href="/guide/shed-concepts.html#listeners" class="sidebar-link">Listeners</a></li><li class="sidebar-sub-header"><a href="/guide/shed-concepts.html#recalling-logs" class="sidebar-link">Recalling Logs</a></li></ul></li><li><a href="/guide/using-shed.html" class="sidebar-link">Using Shed</a></li><li><a href="/guide/unit-testing.html" class="sidebar-link">Unit Testing</a></li><li><a href="/guide/mapped-diagnostic-context.html" class="sidebar-link">Mapped Diagnostic Context (MDC)</a></li><li><a href="/guide/micro-frontends.html" class="sidebar-link">Micro-Frontends</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="shed-concepts"><a href="#shed-concepts" class="header-anchor">#</a> Shed Concepts</h1> <h2 id="what-is-a-shed"><a href="#what-is-a-shed" class="header-anchor">#</a> What is a Shed?</h2> <p>A <strong>Shed</strong> is an optional global cache and control hub for your Adze logs. The primary purposes of a Shed are to enable global configuration overrides and log listeners. To see how a Shed fits into the architecture, refer to the <a href="/guide/adze-concepts.html#lifecycle">Lifecycle Diagram</a>.</p> <p>Shed is also a dependency to take advantage of some log features such as <a href="/guide/modifiers.html#labels">labels</a>, <a href="/guide/modifiers.html#count">counters</a>, and <a href="/guide/modifiers.html#time">timers</a>. Without the presence of a Shed, these log modifiers either do not function or their functionality is stunted.</p> <p>For complete documentation on Shed configuration, go <a href="/config/#shed-configuration">here</a>.</p> <h2 id="how-does-it-work"><a href="#how-does-it-work" class="header-anchor">#</a> How does it work?</h2> <p>One of the primary purposes of the Shed is to enable large project to centrally control how their logs render. Let's imagine we have a large project where we need to split out our code base into multiple packages.</p> <p><img src="/assets/img/large-project.8b843531.svg" alt="Large corporate project with broken into packages"></p> <p>Now that our project has been divided up into reusable packages we'll deploy it.</p> <p>However, after deploying we discovered that we have an error occurring with authentication in the field. During development we usually have debug logs available to us to help sort out where the failure may be occurring, but for production we are stripping them out because we do not have any control over how or when they render.</p> <p>With Shed and Adze we can declare logs within our packages that we want to keep for debugging purposes. Because Adze logs can be hidden and ignored based on log levels, namespaces, or labels we can set global configuration and filters to show or hide them as needed.</p> <h3 id="example"><a href="#example" class="header-anchor">#</a> Example</h3> <p><strong>Authentication Module</strong></p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> adze <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'adze'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Authentication</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> user_context<span class="token operator">:</span> UserContext<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">adze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">'Attempting authentication'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ... do some stuff to authenticate</span>
    <span class="token function">adze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'Authentication successful'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>user_context<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Large Corporate Project</strong></p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> adze<span class="token punctuation">,</span> createShed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'adze'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Authentication <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'authentication'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">ENV</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./environment'</span><span class="token punctuation">;</span>

<span class="token comment">/* We'll get our log level from a value we can control in production. */</span>
<span class="token keyword">const</span> level <span class="token operator">=</span> <span class="token constant">ENV</span><span class="token punctuation">.</span>level<span class="token punctuation">;</span> <span class="token comment">// &lt;- Env.level currently is set to 0.</span>

<span class="token comment">// Let's create a shed to globally control our modules</span>
<span class="token function">createShed</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  global_cfg<span class="token operator">:</span> <span class="token punctuation">{</span>
    log_level<span class="token operator">:</span> level<span class="token punctuation">,</span> <span class="token comment">// &lt;- level is 0 so all logs except alert's are hidden</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Let's run our authentication</span>
Authentication<span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &lt;- No logs are printed</span>
</code></pre></div><p>As you can see in the example code above, although the Authentication class has logs defined our Shed configuration overrides the allowed <code>log_level</code> and sets it to 0. Our debug log has a level of 7 and our success log has a level of 5 thus they are both hidden because their levels are <strong>greater than 0</strong>.</p> <p>You can also see from this example that we can change how our logs are generated in production by changing the value of <code>ENV.level</code>. If we were to change this value to <strong>7</strong> in production we would start seeing our success and debug logs.</p> <h2 id="listeners"><a href="#listeners" class="header-anchor">#</a> Listeners</h2> <p>One of the most powerful features of Adze is the ability to listen for logs and react to them in some way.</p> <p>A log listener is created by calling <code>addListener()</code> on a <a href="#shed-concepts">Shed</a>. When an Adze log terminates, it checks if a Shed exists in the global context (<code>Window</code> for browsers and <code>global</code> for Node). If it does it will attempt to invoke listeners that are targeting that log's level. When a listener is invoked it is provided a <a href="/guide/data.html#log-data">log data object</a> and the <a href="/guide/data.html#log-render">log render</a>. With these data objects Adze enables the user to do with the data as they wish. You could write a log to a file. You could send some data about the log to a REST API. It's up to you.</p> <p>This is a feature that differentiates Adze from other JS logging libraries. Other libraries are typically more focused on Node environments and lock you in to a rigid API for handling the data. Adze takes a different approach by decoupling log data handlers which allows for easier customization and keeps the library lighter weight. As the library and community matures we will add out of the box log data handlers that you can easily install along side of Adze.</p> <h3 id="interface"><a href="#interface" class="header-anchor">#</a> Interface</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Shed</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token function">addListener</span><span class="token punctuation">(</span>
    levels<span class="token operator">:</span> LevelFilter<span class="token punctuation">,</span>
    cb<span class="token operator">:</span> ListenerCallback
  <span class="token punctuation">)</span><span class="token operator">:</span> ListenerLocations<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">ListenerCallback</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  LogData<span class="token operator">:</span> LogData <span class="token operator">|</span> FinalLogData<span class="token punctuation">,</span>
  render<span class="token operator">:</span> LogRender <span class="token operator">|</span> <span class="token keyword">null</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="json-log-example"><a href="#json-log-example" class="header-anchor">#</a> JSON Log Example</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> adze<span class="token punctuation">,</span> createShed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'adze'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> shed <span class="token operator">=</span> <span class="token function">createShed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Let's only listen to levels 1, 2 and 3</span>
shed<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> definition<span class="token punctuation">,</span> timestamp<span class="token punctuation">,</span> args <span class="token punctuation">}</span><span class="token punctuation">,</span> render</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// We only want write logs if they were allowed to render</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>render<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Let's write our log as a JSON object</span>
    <span class="token keyword">const</span> log <span class="token operator">=</span> <span class="token punctuation">{</span>
      level<span class="token operator">:</span> definition<span class="token punctuation">.</span>level<span class="token punctuation">,</span>
      name<span class="token operator">:</span> definition<span class="token punctuation">.</span>levelName<span class="token punctuation">,</span>
      timestamp<span class="token operator">:</span> timestamp<span class="token punctuation">.</span>utc<span class="token punctuation">,</span>
      args<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// You could now write it to a file, send it to a rest API, etc.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="recalling-logs"><a href="#recalling-logs" class="header-anchor">#</a> Recalling Logs</h2> <p>Sometimes you need to recall logs for debugging purposes and you may want to filter them with more detail than the browser console allows. Adze comes with some <a href="/guide/filtering-and-utility-functions.html">filter functions</a> out of the box and that you can use to operate on a <a href="/guide/data.html#collection">collection</a> of logs.</p> <p>When a Shed exists in the global context logs will automatically be cached in it. These logs can then be retrieved at a later time for filtering.</p> <p><em>NOTE:</em> The size of the log cache is <a href="/config/#shed-configuration">configurable</a> and defaults to 300 logs.</p> <h3 id="example-2"><a href="#example-2" class="header-anchor">#</a> Example</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> adze<span class="token punctuation">,</span> createShed<span class="token punctuation">,</span> filterLabel<span class="token punctuation">,</span> rerender <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'adze'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> shed <span class="token operator">=</span> <span class="token function">createShed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Let's create some logs</span>
<span class="token function">adze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">label</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'First log'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">adze</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Second log'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Now we can get them from the Shed</span>
<span class="token keyword">const</span> collection <span class="token operator">=</span> shed<span class="token punctuation">.</span><span class="token function">getCollection</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// And then we can filter them, re-render them, etc.</span>
<span class="token function">filterLabel</span><span class="token punctuation">(</span>collection<span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>rerender<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/data.html" class="prev">
        Data
      </a></span> <span class="next"><a href="/guide/using-shed.html">
        Using Shed
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.57169c33.js" defer></script><script src="/assets/js/2.1b8b686a.js" defer></script><script src="/assets/js/18.99843d9e.js" defer></script>
  </body>
</html>
